{% extends "cms/base.html" %}
{% block extra_css %}
<script src="https://code.jquery.com/jquery-1.12.4.min.js"
  integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<style>
  .button {
    display: flex;
    width: 48px;
    height: 32px;
    line-height: 32px;
    background-color: #3692ff;
    color: #fff;
    justify-content: center;
    align-items: center;
  }
</style>
<script>
  $(function () {
    $('.button').on('click', function (event) {
      event.preventDefault();
      var classVal = $(this).attr('class')
      if (classVal == 'button') {
        $(this).addClass('hit')
        $(this).empty()
        $(this).append('<input type="hidden" name="hit[]" value= "〇"/>')
        $(this).append('〇')
      }
      else if (classVal == 'button hit') {
        $(this).addClass('miss').removeClass('hit')
        $(this).empty()
        $(this).append('<input type="hidden" name="hit[]" value= "×"/>')
        $(this).append('×')
      }
      else if (classVal == 'button miss') {
        $(this).removeClass('miss')
        $(this).empty()
        $(this).append('<input type="hidden" name="hit[]" value= ""/>')
      }
    });
  });
</script>
{% endblock %}

{% load bootstrap4 %}

{% block title %}的中記録の編集{% endblock title %}

{% block content %}

<h4 class="mt-4 mb-5 border-bottom">的中記録の編集</h4>

{% if players %}

<form>
  <div id="div1"></div>
  <input type="button" value="追加" onclick="clickBtn1()">
  <input type="button" value="削除" onclick="clickBtn2()">

  <script>
    function clickBtn1() {
      const div1 = document.getElementById("div1");
      // 要素の追加
      if (!div1.hasChildNodes()) {
        const p1 = document.createElement("p");
        const text1 = document.createTextNode("テスト");
        p1.appendChild(text1);
        div1.appendChild(p1);
      }
    }
    function clickBtn2() {
      // 要素の削除
      const div1 = document.getElementById("div1");
      if (div1.hasChildNodes()) {
        div1.removeChild(div1.firstChild);
      }
    }
  </script>
  <table class="table">
    {% for current_shot in shots %}
    <tr>
      <td>
        {{current_shot}}本目
      </td>
      {% for current_shooting_order in shooting_order %}
      <td align="center">
        <div class="button" data-text-default="Click" data-text-clicked="Done">
        </div>
      </td>
      {% endfor %}
    </tr>
    {% endfor %}
    <tr>
      <td>選手ID</td>
      {% for player in players %}
      <td align="center">
        {{player.id}}
      </td>
      {% endfor %}
    <tr>
      <td>選手名</td>
      {% for player in players %}
      <td align="center">
        {{player.name}}
      </td>
      {% endfor %}
    </tr>
    <tr>
      <td>立順</td>
      {% for current_shooting_order in shooting_order %}
      <td align="center">
        {{ current_shooting_order }}
        <input type="hidden" name="range[]" value= />
      </td>
      {% endfor %}
    </tr>
    <tr>
      <td>団体名</td>
      {% if players.0.team_name == players.1.team_name %}
      <td colspan="3" align="center">
        {{players.0.team_name}}
      </td>
      {% else %}
      <td colspan="3" align="center">
        {{players.0.team_name}}
        {{players.1.team_name}}
        {{players.2.team_name}}
      </td>
      {% endif %}
      {% if players.3.team_name == players.4.team_name == players.5.team_name%}
      <td colspan="3" align="center">
        {{players.3.team_name}}
      </td>
      {% else %}
      <td colspan="3" align="center">
      </td>
      {% endif %}
    </tr>
    <tr>
      <td>射場</td>
      <td colspan="3" align="center">
        第2射場
      </td>
      <td colspan="3" align="center">
        第1射場
      </td>
    </tr>
  </table>
</form>
{% else %}
<form action="{% url 'cms:get_players' competition_id=competition_id match_id=match_id %}" method="POST">
  <table class="table">
    <tr>
      <td>選手ID</td>
      {% for current_shooting_order in shooting_order %}
      <td>
        <input class="form-control" type="text" value="" name="player_id">
      </td>
      {% endfor %}
    </tr>
    <tr>
      <td>立順</td>
      {% for current_shooting_order in shooting_order %}
      <td>
        {{ current_shooting_order }}
        <input type="hidden" name="range[]" value= />
      </td>
      {% endfor %}
    </tr>
    <tr>
      <td>射場</td>
      <td colspan="3">
        第2射場
      </td>
      <td colspan="3">
        第1射場
      </td>
    </tr>
  </table>
  {% csrf_token %}
  <button type="submit" class="btn btn-primary">的中記録開始</button>
</form>
{% endif %}
<br>

<a href="{% url 'cms:match_list' competition_id=competition_id %}" class="btn btn-secondary btn-sm">
  戻る
</a>
{% endblock content %}